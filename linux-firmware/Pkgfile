# Description: Firmware blobs for use with the Linux kernel
# URL:         https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git
# Depends on:  rdfind
# Optional:    parallel

name=linux-firmware
version=20250211
release=1
source="https://git.kernel.org/pub/scm/linux/kernel/git/firmware/$name.git/snapshot/$name-$version.tar.gz
	fsr.patch"

build() {
	patch -d $name-$version -Np1 -i $SRC/fsr.patch

	pkgman isinst parallel || MAKEFLAGS="-j 1"

	make  -C $name-$version FIRMWAREDIR=/lib/firmware DESTDIR=$PKG install
	make  -C $name-$version FIRMWAREDIR=/lib/firmware DESTDIR=$PKG dedup

	# remove junk
	find $PKG -type f \( -name ChangeLog -o -name README \) -delete
}
