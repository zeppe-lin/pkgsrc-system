# Description: RFC2131-compliant DHCP client daemon
# URL:         https://roy.marples.name/projects/dhcpcd
# Depends on:  eudev

name=dhcpcd
version=10.2.4
release=2
source="https://github.com/NetworkConfiguration/$name/releases/download/v$version/$name-$version.tar.xz
	dhcpcd-conf.patch
	rc.$name"

build() {
	# don't invoke wpa_supplicant by default
	patch -d $name-$version -Np1 -i $SRC/dhcpcd-conf.patch

	# build in separate dir is broken
	cd $name-$version

	./configure                       \
		--prefix=                 \
		--sysconfdir=/etc/dhcpcd  \
		--libexecdir=/lib/dhcpcd  \
		--dbdir=/var/lib/dhcpcd   \
		--rundir=/run/dhcpcd      \
		--enable-privsep          \
		--privsepuser=dhcpcd      \
		--with-hook=ntp.conf      \

	make V=1
	make DESTDIR=$PKG install

	install -m 0755 -D $SRC/rc.dhcpcd $PKG/etc/rc.d/dhcpcd

	# fix perms
	chmod -R 0755 $PKG/var
	chmod -R u+w $PKG
}
