# Description: Real-time bandwidth usage information on a network interface 
# URL:         http://www.ex-parrot.com/~pdw/iftop/
# Depends on:  libpcap ncurses

name=iftop
version=1.0pre4
release=3
source="https://pdw.ex-parrot.com/iftop/download/iftop-$version.tar.gz
	bug-debian-1096832-ftbfs-with-GCC-15.patch
	bug-debian-644998-IFF-RUNNING.patch
	bug-debian-962695-ipv6-dns-resolution.patch
	iftop-cleanup.patch
	mac-address-format.patch
	support-multi-gigabit-interfaces.patch"

build() {
	while read -r _patch; do
		patch -d iftop-$version -Np1 -i $SRC/$_patch
	done <<'EOF';
mac-address-format.patch
iftop-cleanup.patch
support-multi-gigabit-interfaces.patch
bug-debian-962695-ipv6-dns-resolution.patch
bug-debian-1096832-ftbfs-with-GCC-15.patch
bug-debian-644998-IFF-RUNNING.patch
EOF
	# build in separate dir is broken
	cd iftop-$version

	./configure --prefix=/usr

	make V=1 CFLAGS="$CFLAGS -fcommon" iftop
	make DESTDIR=$PKG install
}
