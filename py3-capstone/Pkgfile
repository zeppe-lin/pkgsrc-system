# Description: Python bindings for Capstone disassembly framework
# URL:         https://www.capstone-engine.org/index.html
# Depends on:  py3-setuptools

name=py3-capstone
version=5.0.3
release=1
source=https://github.com/aquynh/capstone/archive/$version/capstone-$version.tar.gz

build() {
	export TMPDIR="$PKGMK_WORK_DIR"
	export LIBCAPSTONE_PATH= # Prevent bundled libcapstone from being built.

	cd capstone-$version/bindings/python

	gpep517 build-wheel --wheel-dir .dist --output-fd 3 3>&1 >&2
	/usr/bin/python3 -m installer -d $PKG .dist/*.whl

	/usr/bin/python3     -m compileall $PKG
	/usr/bin/python3 -O  -m compileall $PKG
	/usr/bin/python3 -OO -m compileall $PKG
}
